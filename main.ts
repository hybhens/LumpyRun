enum ActionKind {
    Walking,
    Idle,
    Jumping,
    Dead
}
namespace SpriteKind {
    export const Ground = SpriteKind.create()
    export const Cloud = SpriteKind.create()
}
function initGround () {
    ground1 = sprites.create(img`
        ...................................................................................4444...........................................................................
        ..................................................................................455554..........................................................................
        444444444444444444444444444444444444444444444444444444444444444444444444444444444455555544444444444444444....44444444444444444444444444444444444444444444444444444
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555444455555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        554444554555555555555555555555554554444555555555555555555555555544445545555555555555455555555555555555555555555444455455555555555455444555555555555555554554445555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555444455455555555555555555555555554444545555555455555555555555445455555555444455455555444455455555555555555555545555555555555554444554555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        `, SpriteKind.Ground)
    ground2 = sprites.create(img`
        .....................................................4444..................4444...................................................................................
        ....................................................455554................455554..................................................................................
        444444444444444444444444444444444444444444444444444455555544444444444444445555554444444444444444444444444444444444444444444444444444444444444444444444444444444444
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555544455455555555555555555444554555555555554554444555555555555555555555555554555555555555545544445555555555555555555555555444455455555555555555555555555455444455
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555455444455555555555555545555555555555555554554444555554554444555555554544555555555555554555555545444455555555555555555555555554554444555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
        `, SpriteKind.Ground)
    ground1.setPosition(scene.screenWidth() / 2, 120)
    ground2.setPosition(ground1.x + scene.screenWidth(), 120)
    ground1.vx = -100
    ground2.vx = -100
    ground1.z = 2
    ground2.z = 2
}
function initRaptor () {
    raptor = sprites.create(img`
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ......4.4.4...666...............
        .....45454544691164444444.......
        .....45555555691f666665554......
        ......44444446999999696454......
        .............6999999996.4.......
        .............699966666..........
        .............69696.66...........
        .............696966996..........
        .............696999996..........
        .............696666996..........
        .............69996.66...........
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        ..............696...............
        ..............696...............
        ..............696...............
        ..............696...............
        ..............696...............
        ..............6996..............
        ..............6666..............
        `, SpriteKind.Player)
    run = animation.createAnimation(ActionKind.Walking, 100)
    run.addAnimationFrame(img`
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ......4.4.4...666...............
        .....45454544691164444444.......
        .....45555555691f666665554......
        ......44444446999999696454......
        .............6999999996.4.......
        .............699966666..........
        .............69696.66...........
        .............696966996..........
        .............696999996..........
        .............696666996..........
        .............69996.66...........
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        ..............696...............
        .............69696..............
        ............696.696.............
        .........66696...69666..........
        .........6996.....6996..........
        ..........696.....696...........
        ...........66.....66............
        `)
    run.addAnimationFrame(img`
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ......4.4.4...666...............
        .....45454544691164444444.......
        .....45555555691f666665554......
        ......44444446999999696454......
        .............6999999996.4.......
        .............699966666..........
        .............69696.66...........
        .............696966996..........
        .............696999996..........
        .............696666996..........
        .............69996.66...........
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        ..............696...............
        ..............696...............
        ..............696...............
        ..............696...............
        ..............696...............
        ..............6996..............
        ..............6666..............
        `)
    run.addAnimationFrame(img`
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ......4.4.4...666...............
        .....45454544691164444444.......
        .....45555555691f666665554......
        ......44444446999999696454......
        .............6999999996.4.......
        .............699966666..........
        .............69696.66...........
        .............696966996..........
        .............696999996..........
        .............696666996..........
        .............69996.66...........
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        ..............696...............
        .............69696..............
        ............696.696.............
        .........66696...69666..........
        .........6996.....6996..........
        ..........696.....696...........
        ...........66.....66............
        `)
    animation.attachAnimation(raptor, run)
    jump = animation.createAnimation(ActionKind.Jumping, 200)
    jump.addAnimationFrame(img`
        ................................
        ................................
        ..............666...............
        .............69996..............
        .............69996..............
        ..............696...............
        ..............696...............
        ..............696...............
        ......4.4.4...666...............
        .....45454544691164444444.......
        .....45555555691f666665554......
        ......44444446999999696454......
        .............6999999996.4.......
        .............699966666..........
        .............69696.66...........
        .............696966996..........
        .............696999996..........
        .............696666996..........
        .............69996.66...........
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        ..............696...............
        .............69696..............
        ............696.696.............
        .........66696...69666..........
        .........6996.....6996..........
        ..........696.....696...........
        ...........66.....66............
        `)
    animation.attachAnimation(raptor, jump)
    dead = animation.createAnimation(ActionKind.Dead, 200)
    dead.addAnimationFrame(img`
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ................................
        ......4.4.4...11111.............
        .....45454544611111444444.......
        .....45555555611f116665554......
        ......44444446111119696454......
        .............6111119996.4.......
        .............699966666..........
        .............69696.66...........
        .............696966996..........
        .............696999996..........
        .............696666996..........
        .............69996.66...........
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        .............69996..............
        ..............696...............
        ..............696...............
        ..............696...............
        ..............696...............
        ..............696...............
        ..............6996..............
        ..............6666..............
        `)
    animation.attachAnimation(raptor, dead)
    raptor.z = 3
    raptor.setPosition(15, 94)
}
controller.anyButton.onEvent(ControllerButtonEvent.Pressed, function () {
    if (raptor.y == 94 && end == 0) {
        raptor.vy = -160
        animation.setAction(raptor, ActionKind.Jumping)
    }
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.Projectile, function (sprite, otherSprite) {
    end = 1
    animation.setAction(raptor, ActionKind.Dead)
    pause(50)
    game.over(false, effects.melt)
})
let cloud: Sprite = null
let cactus: Sprite = null
let choice = 0
let dead: animation.Animation = null
let jump: animation.Animation = null
let run: animation.Animation = null
let raptor: Sprite = null
let ground2: Sprite = null
let ground1: Sprite = null
let end = 0
let idle = null
game.setDialogCursor(img`
    ................................
    ..1111111111111111111111111111..
    .111111111111111111111111111111.
    11111111111111111111111111111111
    11111111111111111111111111111111
    11111111111111111111111111111111
    11414141111166666111111111111111
    14545454111699999611111111111111
    14545454444699999644444444441111
    1455555555561f911655555555541111
    144444444446119f1644445454541111
    11111111111699966666666654541111
    11111111111699999999999961411111
    11111111111699999996969961111111
    11111111111699999999999961111111
    11111111111699966666666611111111
    111111111116999f1f1f1f1111111111
    1111111111169999f6f1f11111111111
    11111111111699999611111111111111
    11111111111699999611111111111111
    11111111111699999611111111111111
    11111111111699999611111111111111
    11111111111699999611111111111111
    11111111111699999611111111111111
    11111111111699999611111111111111
    11111111111699999611111111111111
    11111111111699999611111111111111
    11111111111699999611111111111111
    11111111111699999611111111111111
    11111111111699999611111111111111
    .111111111169999961111111111111.
    ..1111111116999996111111111111..
    `)
game.splash("Lumpy Run")
scene.setBackgroundColor(9)
initGround()
initRaptor()
info.setScore(0)
end = 0
game.showLongText("Press any button to jump.", DialogLayout.Top)
game.onUpdate(function () {
    if (raptor.y < 94) {
        raptor.ay = 400
    } else {
        raptor.ay = 0
        raptor.y = 94
        if (end == 0) {
            animation.setAction(raptor, ActionKind.Walking)
        }
    }
})
game.onUpdateInterval(50, function () {
    info.changeScoreBy(1)
})
game.onUpdateInterval(1000, function () {
    ground1.vx += -1
    ground2.vx += -1
})
game.onUpdateInterval(1000, function () {
    choice = randint(0, 4)
    if (choice == 0) {
        cactus = sprites.createProjectileFromSide(img`
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ..............fff...............
            .............f777f..............
            .............f177f..............
            .............f777f...f..........
            .........f...f771f..f7f.........
            ........f7f..f777f..f7f.........
            ........17f..f777f..f1f.........
            ........f7f..f777f..f7f.........
            ........f71fff777f..f7f.........
            ........f77777777f..f7f.........
            .........ffff1777fff17f.........
            .............f77777777f.........
            .............f777fffff..........
            .............f771f..............
            .............f717f..............
            .............f777f..............
            .............f777f..............
            .............f717f..............
            .............f777f..............
            .............f777f..............
            `, ground1.vx, 0)
        cactus.y = 94
        cactus.z = 2
    } else if (choice == 1) {
        cactus = sprites.createProjectileFromSide(img`
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ..............fff...............
            .............f717f..............
            .............f777f..............
            .............f777f..............
            .........f...f771f...f..........
            ........f7f..f777f..f7f.........
            ........f1f..f777f..f71.........
            ........f71..f777f..f7f.........
            ........f7f..f177ffff7f.........
            ........f7f..f77777177f.........
            ........f7ff1f777fffff..........
            ........f17777777f..............
            .........fffff777f..............
            .............f771f..............
            .............f777f..............
            .............1777f..............
            .............f777f..............
            .............f717f..............
            .............f777f..............
            .............f777f..............
            `, ground1.vx, 0)
        cactus.y = 94
        cactus.z = 2
    } else if (choice == 2) {
        cactus = sprites.createProjectileFromSide(img`
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ..............fff........f......
            .............f717f......f7f.....
            .............f777f......f7f.....
            .............f777f......f1f.....
            .............f771f...f..f7f.....
            .............f777f..f7f.f7f.....
            .............f777f..f71.f7f.....
            .........f...f777f..f7ff17f.....
            ........f7f..f177ffff77777f.....
            ........f71..f77777177ffff......
            ........f7ff1f777fffff..........
            ........f17777777f..............
            .........fffff777f..............
            .............f771f..............
            .............f777f..............
            .............1777f..............
            .............f777f..............
            .............f717f..............
            .............f777f..............
            .............f777f..............
            `, ground1.vx, 0)
        cactus.y = 94
        cactus.z = 2
    }
})
game.onUpdateInterval(1500, function () {
    if (Math.percentChance(40)) {
        cloud = sprites.createProjectileFromSide(img`
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            ................................
            .........111....................
            .......111111...................
            ......111111111....1111.........
            ......111111111.111111111.......
            ......11111111111111111111......
            .....1111111111111111111111111..
            ..1111111111111111111111111111..
            .11111111111111111111111111111..
            .11111111111111111111111111111..
            .1111111111111111111111111111...
            .1111111111111111111111111111...
            ..1111111111111111111111111111..
            ..1111111111111111111111111111..
            ..1111111111111111111111111111..
            ..1111111.11111111111111111111..
            ...........111111111..1111111...
            ............11111...............
            ................................
            ................................
            ................................
            `, ground1.vx / 4, 0)
        cloud.y = randint(20, 60)
        cloud.setKind(SpriteKind.Cloud)
        cloud.z = 1
    }
})
forever(function () {
    if (ground2.x < -1 * (scene.screenWidth() / 2)) {
        ground2.x = ground1.x + scene.screenWidth()
    }
})
forever(function () {
    if (ground1.x < -1 * (scene.screenWidth() / 2)) {
        ground1.x = ground2.x + scene.screenWidth()
    }
})
